<!DOCTYPE html>
<html lang="pt-BR">

<head>
     <meta charset="UTF-8">
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <meta name="description" content="Cafeteria Grãos & Aromas - Café artesanal em BH">
     <link rel="icon" href="./img/favcoffee.svg" type="image/svg+xml">
     <title>Grãos & Aromas Cafeteria</title>

     <!-- Tailwind CSS -->
     <script src="https://cdn.tailwindcss.com"></script>

     <!-- Marked.js -->
     <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

     <!-- DOMPurify -->
     <script src="https://cdn.jsdelivr.net/npm/dompurify@2.4.1/dist/purify.min.js"></script>

     <!-- Font -->
     <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;500;700&display=swap" rel="stylesheet">

     <style>
          body {
               font-family: 'Roboto Mono', monospace;
               background-color: #f8f9fa;
               color: #111;
               padding-top: 120px;
          }

          .content-wrapper h1,
          .content-wrapper h2,
          .content-wrapper h3,
          .content-wrapper h4,
          .content-wrapper h5 {
               scroll-margin-top: 130px;
          }

          /* Navbar active link */
          .navbar-link.active {
               font-weight: 700;
               border-bottom: 2px solid #111;
               position: relative;
          }

          /* Badge para o link ativo */
          .navbar-link.active::after {
               content: '●';
               position: absolute;
               top: -6px;
               right: -6px;
               font-size: 0.75rem;
               color: #f59e0b;
               /* laranja suave */
          }
     </style>
</head>

<body class="bg-gray-100">

     <!-- Navbar -->
     <nav class="fixed top-0 left-0 w-full flex items-center gap-4 px-6 py-3 bg-black text-white shadow-md border-b border-gray-800 z-50"
          id="nav-links" role="navigation" aria-label="Navegação principal">
          <img src="./img/favcoffee.svg" alt="Logo Grãos & Aromas" class="w-8 h-8 rounded bg-white p-1 flex-shrink-0">
     </nav>

     <!-- Main Content -->
     <main id="content"
          class="content-wrapper max-w-4xl mx-auto p-10 md:p-12 bg-white rounded-2xl border border-black shadow-xl">
          <h1>Carregando conteúdo...</h1>
     </main>

     <!-- Footer -->
     <footer class="text-center py-10 text-gray-700 text-sm">
          <p>
               <a href="https://github.com/devgbr86" target="_blank" rel="noopener noreferrer">GitHub</a>
               &nbsp;•&nbsp;
               <a href="https://www.linkedin.com/in/devgbr" target="_blank" rel="noopener noreferrer">LinkedIn</a>
               &nbsp;•&nbsp;
               <a href="mailto:topverbs@gmail.com">Email</a>
          </p>
     </footer>

     <script>
          const contentFolder = 'pages/';
          const files = [
               { name: 'Home.md', label: 'Início' },
               { name: 'Carta.md', label: 'Cardápio' },
               { name: 'Mail.md', label: 'Contato' }
          ];

          const navContainer = document.getElementById('nav-links');
          const contentContainer = document.getElementById('content');

          function removeEmojis(text) {
               return text.replace(/[\p{Extended_Pictographic}]/gu, '').trim();
          }

          function applyMarkdownClasses() {
               const c = contentContainer;
               c.querySelectorAll('h1').forEach(el => el.className = 'text-3xl font-bold mb-6 border-b-4 border-black pb-3');
               c.querySelectorAll('h2').forEach(el => el.className = 'text-2xl font-semibold mb-4 border-b-2 border-gray-200 pb-2 mt-10');
               c.querySelectorAll('h3').forEach(el => el.className = 'text-xl font-semibold mb-3 mt-8');
               c.querySelectorAll('p').forEach(el => el.className = 'mb-5 text-gray-900 leading-relaxed');
               c.querySelectorAll('ul').forEach(el => el.className = 'list-disc ml-6 mb-5');
               c.querySelectorAll('ol').forEach(el => el.className = 'list-decimal ml-6 mb-5');
               c.querySelectorAll('li').forEach(el => el.className = 'mb-2');
               c.querySelectorAll('code').forEach(el => el.className = 'bg-gray-100 text-orange-600 px-1 py-0.5 rounded border border-gray-300 text-sm');
               c.querySelectorAll('pre').forEach(el => el.className = 'bg-gray-900 text-gray-200 p-4 rounded-lg border-l-4 border-orange-600 overflow-x-auto mb-6 text-sm');
               c.querySelectorAll('blockquote').forEach(el => el.className = 'border-l-4 border-black bg-gray-100 p-4 rounded my-6 italic text-gray-800');
               c.querySelectorAll('img').forEach(el => {
                    el.className = 'max-w-full rounded-xl my-8 border border-black shadow-lg';
                    el.setAttribute('loading', 'lazy');
               });
               c.querySelectorAll('table').forEach(el => el.className = 'w-full border-collapse my-6');
               c.querySelectorAll('th, td').forEach(el => el.className = 'border border-black px-4 py-2 text-left');
               c.querySelectorAll('th').forEach(el => el.className += ' bg-gray-200 font-semibold');
               c.querySelectorAll('tr:nth-child(even)').forEach(el => el.className = 'bg-gray-50');
               c.querySelectorAll('a').forEach(el => el.className = 'text-orange-600 font-medium no-underline');
          }

          async function loadMarkdown(file = 'Home.md') {
               try {
                    const res = await fetch(`${contentFolder}${file}`);
                    if (!res.ok) throw new Error(`HTTP ${res.status}`);

                    const markdown = await res.text();
                    const cleanMarkdown = removeEmojis(markdown);
                    const rawHtml = marked.parse(cleanMarkdown);
                    const sanitized = DOMPurify.sanitize(rawHtml, { ADD_TAGS: ['span', 'div'], ADD_ATTR: ['id', 'class'] });
                    contentContainer.innerHTML = sanitized;

                    applyMarkdownClasses();
                    window.scrollTo({ top: 0, behavior: 'smooth' });
               } catch (err) {
                    contentContainer.innerHTML = `
                    <h1>Erro ao carregar</h1>
                    <p>Não foi possível carregar o arquivo <code>${file}</code>.</p>
                    <p>Verifique se ele existe em <code>${contentFolder}</code>.</p>
                `;
               }
          }

          // Criar links da Navbar
          files.forEach((file, index) => {
               const link = document.createElement('a');
               link.textContent = file.label;
               link.className = 'navbar-link text-sm px-2 py-1 rounded';
               if (index === 0) link.classList.add('active');
               link.href = '#';
               link.addEventListener('click', e => {
                    e.preventDefault();
                    document.querySelectorAll('.navbar-link').forEach(l => l.classList.remove('active'));
                    link.classList.add('active');
                    loadMarkdown(file.name);
               });
               navContainer.appendChild(link);
          });

          document.addEventListener('DOMContentLoaded', () => {
               loadMarkdown(files[0].name);
          });
     </script>
</body>

</html>